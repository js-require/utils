class Enumerable{constructor(t){this.data=Array.isArray(t)?t:[t]}where(t){return this.data=this.data.filter(t),this}select(t){return this.data=this.data.map(t),this}take(t){return this.data=this.data.slice(0,t),this}skip(t){return this.data=this.data.slice(t),this}orderBy(t,e=!1){return this.data.sort((r,a)=>{let s=t(r),i=t(a);return s<i?e?1:-1:s>i?e?-1:1:0}),this}orderByDescending(t){return this.orderBy(t,!0)}distinct(t=t=>t){let e=new Set;return this.data=this.data.filter(r=>{let a=t(r);return!e.has(a)&&(e.add(a),!0)}),this}groupBy(t){let e=new Map;return this.data.forEach(r=>{let a=t(r);e.has(a)||e.set(a,[]),e.get(a).push(r)}),this.data=Array.from(e,([t,e])=>({key:t,values:e})),this}join(t,e,r,a){let s=new Map;return t.forEach(t=>{let e=r(t);s.has(e)||s.set(e,[]),s.get(e).push(t)}),this.data=this.data.flatMap(t=>{let r=e(t),i=s.get(r)||[];return i.map(e=>a(t,e))}),this}concat(...t){return this.data=this.data.concat(...t),this}first(t=null){return t?this.data.find(t):this.data[0]}last(t=null){if(t){let e=this.data.filter(t);return e[e.length-1]}return this.data[this.data.length-1]}count(t=null){return t?this.data.filter(t).length:this.data.length}any(t=null){return t?this.data.some(t):this.data.length>0}all(t){return this.data.every(t)}sum(t=t=>t){return this.data.reduce((e,r)=>e+t(r),0)}average(t=t=>t){return 0===this.data.length?0:this.sum(t)/this.data.length}max(t=t=>t){return Math.max(...this.data.map(t))}min(t=t=>t){return Math.min(...this.data.map(t))}partition(t){let e=[],r=[];return this.data.forEach(a=>{t(a)?e.push(a):r.push(a)}),[new Enumerable(e),new Enumerable(r)]}toArray(){return this.data}toJson(){return JSON.stringify(this.data)}}const numbers=[1,2,3,4,5,6,7,8,9,10],result=new Enumerable(numbers).where(t=>t%2==0).select(t=>t*t).take(3).toArray();console.log(result);const products=[{id:1,name:"Laptop",price:1e3,category:"Electronics"},{id:2,name:"Mouse",price:25,category:"Electronics"},{id:3,name:"Desk",price:300,category:"Furniture"},{id:4,name:"Chair",price:150,category:"Furniture"}],expensiveProducts=new Enumerable(products).where(t=>t.price>100).orderBy(t=>t.price).select(t=>({name:t.name,price:t.price})).toArray();console.log(expensiveProducts);const grouped=new Enumerable(products).groupBy(t=>t.category).toArray();console.log(grouped),module.exports=Enumerable;
